# –ü—Ä–∞–≤–∏–ª–æ: –ó–∞–ø–∏—Å—å –≤ pending updates (–¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –±–µ–∑ git commit)

## –ö–æ–≥–¥–∞ –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å

–ï—Å–ª–∏ —Ç—ã –∏–∑–º–µ–Ω—è–µ—à—å –∫–æ–¥ **–ë–ï–ó git commit** (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞–±–æ—Ç–∞–µ—à—å –≤ Cursor –Ω–∞ —É–¥–∞–ª—ë–Ω–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—à—å —Ñ–∞–π–ª—ã):

1. –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–æ–¥–∞
2. –ï—Å–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—é—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –∏–ª–∏ API
3. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å **–Ω–µ** –∑–∞–ø—É—Å—Ç–∏–ª –∫–æ–º–∞–Ω–¥—É `==` —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

## –ö–∞–∫ –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å

### –§–æ—Ä–º–∞—Ç –∑–∞–ø–∏—Å–∏

```
<timestamp>|<kind>|<ref>|<files>|<doc_hint>|<note>
```

**–ü–æ–ª—è:**
- `timestamp` ‚Äî Unix timestamp: `$(date +%s)`
- `kind` ‚Äî —Ç–∏–ø –∏–∑–º–µ–Ω–µ–Ω–∏—è: `code` (–∫–æ–¥), `infra` (–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞), `schema` (—Å—Ö–µ–º–∞ –ë–î)
- `ref` ‚Äî –∏—Å—Ç–æ—á–Ω–∏–∫: `cursor`, `manual`, `ai-edit`
- `files` ‚Äî —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ **TAB** (`\t`): `file1.ts\tfile2.ts`
- `doc_hint` ‚Äî –∫—É–¥–∞ –æ–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é: `docs/features/`, `docs/architecture/`, `docs/infrastructure/`
- `note` ‚Äî –∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ: `Cursor Agent` –∏–ª–∏ `Added auth middleware`

### –ü—Ä–∏–º–µ—Ä –∫–æ–º–∞–Ω–¥—ã

```bash
echo "$(date +%s)|code|cursor|src/auth/middleware.ts\tsrc/routes/api.ts|docs/features/auth/|Added JWT validation" >> .ai-docs-system/state/pending-updates.queue
```

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ doc_hint

–ò—Å–ø–æ–ª—å–∑—É–π –º–∞–ø–ø–∏–Ω–≥ –∏–∑ `config.env`:

- **MAP_FEATURES** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `src/,app/,lib/`) ‚Üí `docs/features/`
- **MAP_ARCHITECTURE** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `schema,models,types`) ‚Üí `docs/architecture/`
- **MAP_INFRASTRUCTURE** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `deploy,docker,supabase`) ‚Üí `docs/infrastructure/`

–ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –º–∞–ø–ø–∏–Ω–≥—É ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π `docs/`

### Fallback –¥–ª—è –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –ø—É—Ç–µ–π

–ï—Å–ª–∏ –≤ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ –µ—Å—Ç—å `|`, `\t` –∏–ª–∏ `\n` ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π `.queue0` —Ñ–æ—Ä–º–∞—Ç (NUL-separated):

```bash
{
  printf '%s\0%s\0%s\0' "$(date +%s)" "code" "cursor"
  printf '%s\0' "file with | pipe.ts" "another\tfile.ts"
  printf '\0%s\0%s\0\0' "docs/features/" "Cursor Agent"
} >> .ai-docs-system/state/pending-updates.queue0
```

## –ü–æ—Å–ª–µ –∑–∞–ø–∏—Å–∏

–ù–∞–ø–æ–º–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é:

```
üìù –ò–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–ø–∏—Å–∞–Ω—ã –≤ pending updates.
üí° –ó–∞–ø—É—Å—Ç–∏ "==" —á—Ç–æ–±—ã –æ–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é.
```

## –ö–æ–≥–¥–∞ –ù–ï –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —è–≤–Ω–æ –ø–æ–ø—Ä–æ—Å–∏–ª **—Ç–æ–ª—å–∫–æ** –∏–∑–º–µ–Ω–∏—Ç—å –∫–æ–¥ (–±–µ–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏)
- –ò–∑–º–µ–Ω–µ–Ω–∏—è —Ç—Ä–∏–≤–∏–∞–ª—å–Ω—ã–µ (—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –æ–ø–µ—á–∞—Ç–∫–∏)
- –£–∂–µ –∑–∞–ø—É—â–µ–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ `==` –≤ —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏
- –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ñ–∞–π–ª–∞—Ö –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è (`IGNORE_DIRS` –∏–∑ `config.env`)

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –∑–∞–ø–∏—Å—å—é

```bash
# –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ config —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
config=".ai-docs-system/config.env"
[[ ! -f "$config" ]] && echo "AI Docs System –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω" && exit

# –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –∑–∞–ø–∏—Å—å –≤–∫–ª—é—á–µ–Ω–∞
pending_write=$(grep "^PENDING_UPDATES_WRITE=" "$config" | cut -d'=' -f2)
[[ "$pending_write" == "off" ]] && echo "–ó–∞–ø–∏—Å—å –≤ pending updates –æ—Ç–∫–ª—é—á–µ–Ω–∞" && exit

# –°–æ–∑–¥–∞–π –ø–∞–ø–∫—É state –µ—Å–ª–∏ –Ω–µ—Ç
mkdir -p .ai-docs-system/state
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **–ù–ï** –∑–∞–ø–∏—Å—ã–≤–∞–π sensitive –¥–∞–Ω–Ω—ã–µ –≤ note (–ø–∞—Ä–æ–ª–∏, —Ç–æ–∫–µ–Ω—ã)
- **–ù–ï** –∑–∞–ø–∏—Å—ã–≤–∞–π –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º —Å —Å–µ–∫—Ä–µ—Ç–∞–º–∏ (`.env`, `credentials.json`)
- **–ù–ï** –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–π –≤—Å—é –æ—á–µ—Ä–µ–¥—å ‚Äî —Ç–æ–ª—å–∫–æ –¥–æ–±–∞–≤–ª—è–π (`>>`, –Ω–µ `>`)
